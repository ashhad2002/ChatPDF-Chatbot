{"version":3,"file":"view.js","mappings":"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","sources":["webpack://chatpdf-bot/./src/editor.scss","webpack://chatpdf-bot/external window \"React\"","webpack://chatpdf-bot/external window [\"wp\",\"apiFetch\"]","webpack://chatpdf-bot/external window [\"wp\",\"domReady\"]","webpack://chatpdf-bot/external window [\"wp\",\"element\"]","webpack://chatpdf-bot/webpack/bootstrap","webpack://chatpdf-bot/webpack/runtime/compat get default export","webpack://chatpdf-bot/webpack/runtime/define property getters","webpack://chatpdf-bot/webpack/runtime/hasOwnProperty shorthand","webpack://chatpdf-bot/webpack/runtime/make namespace object","webpack://chatpdf-bot/./src/view.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"domReady\"];","module.exports = window[\"wp\"][\"element\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import domReady from \"@wordpress/dom-ready\"\r\nimport { render } from  '@wordpress/element'\r\nimport { useState, useRef, useEffect } from '@wordpress/element';\r\nimport apiFetch from \"@wordpress/api-fetch\";\r\nimport './editor.scss';\r\n\r\nconst App = () => {\r\n    const [newQuestion, setNewQuestion] = useState(\"\");\r\n\tconst [chatLog, setChatLog] = useState([\"Enter your questions here\"]);\r\n\tconst [gettingResponse, setGettingResponse] = useState(false);\r\n\tconst logContainerRef = useRef(null);\r\n\tconst inputRef = useRef(null);\r\n\tconst [chatopen, setChatopen] = useState(false);\r\n\r\n    const toggle = (e) => {\r\n        setChatopen(!chatopen);\r\n        if (window.innerWidth <= 430 && chatopen) {\r\n\r\n        }\r\n        };\r\n    \r\n    useEffect(() => {\r\n        logContainerRef.current.scrollTop = logContainerRef.current.scrollHeight;\r\n        }, [chatLog]);\r\n\r\n    const sendMessage = (data) => {\r\n        return new Promise((resolve, reject) => {\r\n            apiFetch( {\r\n                path: 'v1/chat',\r\n                method: 'POST',\r\n                data: data,\r\n            }).then((res) => {\r\n                resolve(res);\r\n            }).catch((error) => {\r\n                reject(error);\r\n            });            \r\n        });\r\n    };\r\n\r\n\r\n    function constructMessages(messages) {\r\n        const roles = ['assistant', 'user'];\r\n        let constructedMessages = [];\r\n    \r\n        for (let i = 0; i < messages.length; i++) {\r\n            const index = i % 2;\r\n            const message = messages[i];\r\n    \r\n            const constructedMessage = {\r\n                role: roles[index],\r\n                content: message\r\n            };\r\n    \r\n            constructedMessages.push(constructedMessage);\r\n        }\r\n    \r\n        return constructedMessages;\r\n    }\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        if (!inputRef.current.value) return;\r\n        setGettingResponse(true);\r\n        inputRef.current.value = '';\r\n        const data = {\r\n            sourceId: \"cha_\" + chatpdf_chatbot_settings.api_key,\r\n            };\r\n        let lastSixMessages = chatLog.slice(-5);\r\n        data.messages = constructMessages([...lastSixMessages, newQuestion]);\r\n        setChatLog(prevLog => [...prevLog, newQuestion]);\r\n        // sendMessage(data)\r\n        // .then((result) => {\r\n        //     if(result.content) setChatLog(prevLog => [...prevLog, result.content]);\r\n        //     else if(result.error) setChatLog(prevLog => [...prevLog, result.error]);\r\n        //     else {\r\n        //         console.error(\"Error:\", error);\r\n        //         setChatLog(prevLog => [...prevLog, \"Error getting response\"]);\r\n        //     }\r\n        // })\r\n        // .catch((error) => {\r\n        //     console.error(\"Error:\", error);\r\n        //     setChatLog(prevLog => [...prevLog, \"Error getting response\"]);\r\n        // })\r\n        // .finally(() => {\r\n        //     setGettingResponse(false);\r\n        // })\r\n        setGettingResponse(false); //useful for testing, after commenting out above block\r\n        };\r\n    \r\n    const handleKeyDown = (event) => {\r\n        if (event.key === 'Enter' && !event.shiftKey && !gettingResponse && inputRef.current.value) {\r\n        handleSubmit(event);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div id=\"chatCon\">\r\n\t\t\t<div className={`chat-box ${chatopen ? 'visible' : 'hidden'}`}>\r\n\t\t\t\t<div class=\"header\">Chatbot\r\n                <i onClick={toggle} className=\"fa fa-times fa-lg chatbot-toggler-mobile\"></i>\r\n                </div>\r\n\t\t\t\t<div class=\"msg-area\" ref={logContainerRef}>\r\n\t\t\t\t{chatLog.map((msg, i) =>\r\n\t\t\t\t\ti % 2 ? (\r\n\t\t\t\t\t<p className='usrmsg'>\r\n\t\t\t\t\t\t<span className=\"userspan\">{msg}</span>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<span>{msg}</span>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t)\r\n\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"footer\">\r\n                    <textarea \r\n                    placeholder=\"Send your message here...\"\r\n                    onKeyDown={handleKeyDown}\r\n\t\t\t\t\tonChange={(e) => setNewQuestion(e.target.value)}\r\n                    rows={1}\r\n                    ref={inputRef} \r\n                    className=\"chatinput\" />\r\n\t\t\t\t\t<button\r\n\t\t\t\t\tdisabled={gettingResponse}\r\n\t\t\t\t\tonClick={handleSubmit}>\r\n\t\t\t\t\t\t<i class=\"fa fa-paper-plane\"></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div onClick={toggle} class=\"pop\">\r\n                {chatopen ? (\r\n                    <i className=\"fa fa-times fa-lg chatbot-toggler\"></i> // Close icon\r\n                ) : (\r\n                    <i className=\"fa fa-comment fa-lg chatbot-toggler\"></i> // Chat icon\r\n                )}\r\n\t\t\t</div>\r\n\t\t</div>\r\n    );\r\n};\r\ndomReady(function () {\r\n    const container = document.querySelector('#app');\r\n    render(<App />, container);\r\n})\r\n"],"names":["domReady","render","useState","useRef","useEffect","apiFetch","App","newQuestion","setNewQuestion","chatLog","setChatLog","gettingResponse","setGettingResponse","logContainerRef","inputRef","chatopen","setChatopen","toggle","e","window","innerWidth","current","scrollTop","scrollHeight","sendMessage","data","Promise","resolve","reject","path","method","then","res","catch","error","constructMessages","messages","roles","constructedMessages","i","length","index","message","constructedMessage","role","content","push","handleSubmit","preventDefault","value","sourceId","chatpdf_chatbot_settings","api_key","lastSixMessages","slice","prevLog","handleKeyDown","event","key","shiftKey","createElement","id","className","class","onClick","ref","map","msg","placeholder","onKeyDown","onChange","target","rows","disabled","container","document","querySelector"],"sourceRoot":""}